{"dependencies":[{"name":"zustand","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":33,"index":33}}],"key":"POPvx7yS3Y3wz+S/9OAefiXNs0Q=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":34},"end":{"line":2,"column":69,"index":103}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":104},"end":{"line":3,"column":26,"index":130}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"useChatStore\", {\n    enumerable: true,\n    get: function () {\n      return useChatStore;\n    }\n  });\n  var _zustand = require(_dependencyMap[0], \"zustand\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _axios = require(_dependencyMap[2], \"axios\");\n  var axios = _interopDefault(_axios);\n  const API_URL = process.env.EXPO_PUBLIC_BACKEND_URL || '';\n  const useChatStore = (0, _zustand.create)((set, get) => ({\n    messages: [],\n    personality: 'superintendent',\n    conversationId: null,\n    isLoading: false,\n    error: null,\n    setPersonality: async personality => {\n      set({\n        personality\n      });\n      await AsyncStorage.default.setItem('personality', personality);\n\n      // Call backend to update personality\n      try {\n        await axios.default.post(`${API_URL}/api/personality/toggle`, {\n          personality\n        });\n      } catch (error) {\n        console.error('Error updating personality:', error);\n      }\n    },\n    sendMessage: async message => {\n      const {\n        personality,\n        conversationId,\n        messages\n      } = get();\n\n      // Add user message immediately\n      const userMessage = {\n        role: 'user',\n        content: message,\n        timestamp: new Date()\n      };\n      set({\n        messages: [...messages, userMessage],\n        isLoading: true,\n        error: null\n      });\n      try {\n        const response = await axios.default.post(`${API_URL}/api/chat`, {\n          message,\n          personality,\n          conversation_id: conversationId\n        });\n        const {\n          data\n        } = response;\n        if (data.success) {\n          const assistantMessage = {\n            role: 'assistant',\n            content: data.response,\n            timestamp: new Date(),\n            model_used: data.model_used\n          };\n          set(state => ({\n            messages: [...state.messages, assistantMessage],\n            conversationId: data.conversation_id,\n            isLoading: false\n          }));\n\n          // Persist conversation ID\n          await AsyncStorage.default.setItem('conversationId', data.conversation_id);\n        }\n      } catch (error) {\n        console.error('Error sending message:', error);\n        set({\n          error: error.response?.data?.detail || error.message || 'Failed to send message',\n          isLoading: false\n        });\n      }\n    },\n    clearMessages: async () => {\n      set({\n        messages: [],\n        conversationId: null,\n        error: null\n      });\n      await AsyncStorage.default.removeItem('conversationId');\n    },\n    loadPersistedData: async () => {\n      try {\n        const [savedPersonality, savedConversationId] = await Promise.all([AsyncStorage.default.getItem('personality'), AsyncStorage.default.getItem('conversationId')]);\n        if (savedPersonality) {\n          set({\n            personality: savedPersonality\n          });\n        }\n        if (savedConversationId) {\n          // Load conversation history from backend\n          try {\n            const response = await axios.default.get(`${API_URL}/api/conversations/${savedConversationId}`);\n            const conversation = response.data;\n            const loadedMessages = conversation.messages.map(msg => ({\n              role: msg.role,\n              content: msg.content,\n              timestamp: new Date(msg.timestamp),\n              model_used: msg.model_used\n            }));\n            set({\n              messages: loadedMessages,\n              conversationId: savedConversationId,\n              personality: conversation.personality\n            });\n          } catch (error) {\n            console.error('Error loading conversation:', error);\n            // Clear invalid conversation ID\n            await AsyncStorage.default.removeItem('conversationId');\n          }\n        }\n      } catch (error) {\n        console.error('Error loading persisted data:', error);\n      }\n    }\n  }));\n});","lineCount":139,"map":[[12,2,30,0,"Object"],[12,8,30,0],[12,9,30,0,"defineProperty"],[12,23,30,0],[12,24,30,0,"exports"],[12,31,30,0],[13,4,30,0,"enumerable"],[13,14,30,0],[14,4,30,0,"get"],[14,7,30,0],[14,18,30,0,"get"],[14,19,30,0],[15,6,30,0],[15,13,30,0,"useChatStore"],[15,25,30,0],[16,4,30,0],[17,2,30,0],[18,2,1,0],[18,6,1,0,"_zustand"],[18,14,1,0],[18,17,1,0,"require"],[18,24,1,0],[18,25,1,0,"_dependencyMap"],[18,39,1,0],[19,2,2,0],[19,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[19,42,2,0],[19,45,2,0,"require"],[19,52,2,0],[19,53,2,0,"_dependencyMap"],[19,67,2,0],[20,2,2,0],[20,6,2,0,"AsyncStorage"],[20,18,2,0],[20,21,2,0,"_interopDefault"],[20,36,2,0],[20,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[20,73,2,0],[21,2,3,0],[21,6,3,0,"_axios"],[21,12,3,0],[21,15,3,0,"require"],[21,22,3,0],[21,23,3,0,"_dependencyMap"],[21,37,3,0],[22,2,3,0],[22,6,3,0,"axios"],[22,11,3,0],[22,14,3,0,"_interopDefault"],[22,29,3,0],[22,30,3,0,"_axios"],[22,36,3,0],[23,2,28,0],[23,8,28,6,"API_URL"],[23,15,28,13],[23,18,28,16,"process"],[23,25,28,23],[23,26,28,24,"env"],[23,29,28,27],[23,30,28,28,"EXPO_PUBLIC_BACKEND_URL"],[23,53,28,51],[23,57,28,55],[23,59,28,57],[24,2,30,7],[24,8,30,13,"useChatStore"],[24,20,30,25],[24,23,30,28],[24,27,30,28,"create"],[24,35,30,34],[24,36,30,34,"create"],[24,42,30,34],[24,44,30,46],[24,45,30,47,"set"],[24,48,30,50],[24,50,30,52,"get"],[24,53,30,55],[24,59,30,61],[25,4,31,2,"messages"],[25,12,31,10],[25,14,31,12],[25,16,31,14],[26,4,32,2,"personality"],[26,15,32,13],[26,17,32,15],[26,33,32,31],[27,4,33,2,"conversationId"],[27,18,33,16],[27,20,33,18],[27,24,33,22],[28,4,34,2,"isLoading"],[28,13,34,11],[28,15,34,13],[28,20,34,18],[29,4,35,2,"error"],[29,9,35,7],[29,11,35,9],[29,15,35,13],[30,4,37,2,"setPersonality"],[30,18,37,16],[30,20,37,18],[30,26,37,25,"personality"],[30,37,37,49],[30,41,37,54],[31,6,38,4,"set"],[31,9,38,7],[31,10,38,8],[32,8,38,10,"personality"],[33,6,38,22],[33,7,38,23],[33,8,38,24],[34,6,39,4],[34,12,39,10,"AsyncStorage"],[34,24,39,22],[34,25,39,22,"default"],[34,32,39,22],[34,33,39,23,"setItem"],[34,40,39,30],[34,41,39,31],[34,54,39,44],[34,56,39,46,"personality"],[34,67,39,57],[34,68,39,58],[36,6,41,4],[37,6,42,4],[37,10,42,8],[38,8,43,6],[38,14,43,12,"axios"],[38,19,43,17],[38,20,43,17,"default"],[38,27,43,17],[38,28,43,18,"post"],[38,32,43,22],[38,33,43,23],[38,36,43,26,"API_URL"],[38,43,43,33],[38,68,43,58],[38,70,43,60],[39,10,43,62,"personality"],[40,8,43,74],[40,9,43,75],[40,10,43,76],[41,6,44,4],[41,7,44,5],[41,8,44,6],[41,15,44,13,"error"],[41,20,44,18],[41,22,44,20],[42,8,45,6,"console"],[42,15,45,13],[42,16,45,14,"error"],[42,21,45,19],[42,22,45,20],[42,51,45,49],[42,53,45,51,"error"],[42,58,45,56],[42,59,45,57],[43,6,46,4],[44,4,47,2],[44,5,47,3],[45,4,49,2,"sendMessage"],[45,15,49,13],[45,17,49,15],[45,23,49,22,"message"],[45,30,49,37],[45,34,49,42],[46,6,50,4],[46,12,50,10],[47,8,50,12,"personality"],[47,19,50,23],[48,8,50,25,"conversationId"],[48,22,50,39],[49,8,50,41,"messages"],[50,6,50,50],[50,7,50,51],[50,10,50,54,"get"],[50,13,50,57],[50,14,50,58],[50,15,50,59],[52,6,52,4],[53,6,53,4],[53,12,53,10,"userMessage"],[53,23,53,30],[53,26,53,33],[54,8,54,6,"role"],[54,12,54,10],[54,14,54,12],[54,20,54,18],[55,8,55,6,"content"],[55,15,55,13],[55,17,55,15,"message"],[55,24,55,22],[56,8,56,6,"timestamp"],[56,17,56,15],[56,19,56,17],[56,23,56,21,"Date"],[56,27,56,25],[56,28,56,26],[57,6,57,4],[57,7,57,5],[58,6,59,4,"set"],[58,9,59,7],[58,10,59,8],[59,8,60,6,"messages"],[59,16,60,14],[59,18,60,16],[59,19,60,17],[59,22,60,20,"messages"],[59,30,60,28],[59,32,60,30,"userMessage"],[59,43,60,41],[59,44,60,42],[60,8,61,6,"isLoading"],[60,17,61,15],[60,19,61,17],[60,23,61,21],[61,8,62,6,"error"],[61,13,62,11],[61,15,62,13],[62,6,63,4],[62,7,63,5],[62,8,63,6],[63,6,65,4],[63,10,65,8],[64,8,66,6],[64,14,66,12,"response"],[64,22,66,20],[64,25,66,23],[64,31,66,29,"axios"],[64,36,66,34],[64,37,66,34,"default"],[64,44,66,34],[64,45,66,35,"post"],[64,49,66,39],[64,50,66,40],[64,53,66,43,"API_URL"],[64,60,66,50],[64,71,66,61],[64,73,66,63],[65,10,67,8,"message"],[65,17,67,15],[66,10,68,8,"personality"],[66,21,68,19],[67,10,69,8,"conversation_id"],[67,25,69,23],[67,27,69,25,"conversationId"],[68,8,70,6],[68,9,70,7],[68,10,70,8],[69,8,72,6],[69,14,72,12],[70,10,72,14,"data"],[71,8,72,19],[71,9,72,20],[71,12,72,23,"response"],[71,20,72,31],[72,8,74,6],[72,12,74,10,"data"],[72,16,74,14],[72,17,74,15,"success"],[72,24,74,22],[72,26,74,24],[73,10,75,8],[73,16,75,14,"assistantMessage"],[73,32,75,39],[73,35,75,42],[74,12,76,10,"role"],[74,16,76,14],[74,18,76,16],[74,29,76,27],[75,12,77,10,"content"],[75,19,77,17],[75,21,77,19,"data"],[75,25,77,23],[75,26,77,24,"response"],[75,34,77,32],[76,12,78,10,"timestamp"],[76,21,78,19],[76,23,78,21],[76,27,78,25,"Date"],[76,31,78,29],[76,32,78,30],[76,33,78,31],[77,12,79,10,"model_used"],[77,22,79,20],[77,24,79,22,"data"],[77,28,79,26],[77,29,79,27,"model_used"],[78,10,80,8],[78,11,80,9],[79,10,82,8,"set"],[79,13,82,11],[79,14,82,12,"state"],[79,19,82,17],[79,24,82,22],[80,12,83,10,"messages"],[80,20,83,18],[80,22,83,20],[80,23,83,21],[80,26,83,24,"state"],[80,31,83,29],[80,32,83,30,"messages"],[80,40,83,38],[80,42,83,40,"assistantMessage"],[80,58,83,56],[80,59,83,57],[81,12,84,10,"conversationId"],[81,26,84,24],[81,28,84,26,"data"],[81,32,84,30],[81,33,84,31,"conversation_id"],[81,48,84,46],[82,12,85,10,"isLoading"],[82,21,85,19],[82,23,85,21],[83,10,86,8],[83,11,86,9],[83,12,86,10],[83,13,86,11],[85,10,88,8],[86,10,89,8],[86,16,89,14,"AsyncStorage"],[86,28,89,26],[86,29,89,26,"default"],[86,36,89,26],[86,37,89,27,"setItem"],[86,44,89,34],[86,45,89,35],[86,61,89,51],[86,63,89,53,"data"],[86,67,89,57],[86,68,89,58,"conversation_id"],[86,83,89,73],[86,84,89,74],[87,8,90,6],[88,6,91,4],[88,7,91,5],[88,8,91,6],[88,15,91,13,"error"],[88,20,91,23],[88,22,91,25],[89,8,92,6,"console"],[89,15,92,13],[89,16,92,14,"error"],[89,21,92,19],[89,22,92,20],[89,46,92,44],[89,48,92,46,"error"],[89,53,92,51],[89,54,92,52],[90,8,93,6,"set"],[90,11,93,9],[90,12,93,10],[91,10,94,8,"error"],[91,15,94,13],[91,17,94,15,"error"],[91,22,94,20],[91,23,94,21,"response"],[91,31,94,29],[91,33,94,31,"data"],[91,37,94,35],[91,39,94,37,"detail"],[91,45,94,43],[91,49,94,47,"error"],[91,54,94,52],[91,55,94,53,"message"],[91,62,94,60],[91,66,94,64],[91,90,94,88],[92,10,95,8,"isLoading"],[92,19,95,17],[92,21,95,19],[93,8,96,6],[93,9,96,7],[93,10,96,8],[94,6,97,4],[95,4,98,2],[95,5,98,3],[96,4,100,2,"clearMessages"],[96,17,100,15],[96,19,100,17],[96,25,100,17,"clearMessages"],[96,26,100,17],[96,31,100,29],[97,6,101,4,"set"],[97,9,101,7],[97,10,101,8],[98,8,102,6,"messages"],[98,16,102,14],[98,18,102,16],[98,20,102,18],[99,8,103,6,"conversationId"],[99,22,103,20],[99,24,103,22],[99,28,103,26],[100,8,104,6,"error"],[100,13,104,11],[100,15,104,13],[101,6,105,4],[101,7,105,5],[101,8,105,6],[102,6,106,4],[102,12,106,10,"AsyncStorage"],[102,24,106,22],[102,25,106,22,"default"],[102,32,106,22],[102,33,106,23,"removeItem"],[102,43,106,33],[102,44,106,34],[102,60,106,50],[102,61,106,51],[103,4,107,2],[103,5,107,3],[104,4,109,2,"loadPersistedData"],[104,21,109,19],[104,23,109,21],[104,29,109,21,"loadPersistedData"],[104,30,109,21],[104,35,109,33],[105,6,110,4],[105,10,110,8],[106,8,111,6],[106,14,111,12],[106,15,111,13,"savedPersonality"],[106,31,111,29],[106,33,111,31,"savedConversationId"],[106,52,111,50],[106,53,111,51],[106,56,111,54],[106,62,111,60,"Promise"],[106,69,111,67],[106,70,111,68,"all"],[106,73,111,71],[106,74,111,72],[106,75,112,8,"AsyncStorage"],[106,87,112,20],[106,88,112,20,"default"],[106,95,112,20],[106,96,112,21,"getItem"],[106,103,112,28],[106,104,112,29],[106,117,112,42],[106,118,112,43],[106,120,113,8,"AsyncStorage"],[106,132,113,20],[106,133,113,20,"default"],[106,140,113,20],[106,141,113,21,"getItem"],[106,148,113,28],[106,149,113,29],[106,165,113,45],[106,166,113,46],[106,167,114,7],[106,168,114,8],[107,8,116,6],[107,12,116,10,"savedPersonality"],[107,28,116,26],[107,30,116,28],[108,10,117,8,"set"],[108,13,117,11],[108,14,117,12],[109,12,117,14,"personality"],[109,23,117,25],[109,25,117,27,"savedPersonality"],[110,10,117,59],[110,11,117,60],[110,12,117,61],[111,8,118,6],[112,8,120,6],[112,12,120,10,"savedConversationId"],[112,31,120,29],[112,33,120,31],[113,10,121,8],[114,10,122,8],[114,14,122,12],[115,12,123,10],[115,18,123,16,"response"],[115,26,123,24],[115,29,123,27],[115,35,123,33,"axios"],[115,40,123,38],[115,41,123,38,"default"],[115,48,123,38],[115,49,123,39,"get"],[115,52,123,42],[115,53,123,43],[115,56,123,46,"API_URL"],[115,63,123,53],[115,85,123,75,"savedConversationId"],[115,104,123,94],[115,106,123,96],[115,107,123,97],[116,12,124,10],[116,18,124,16,"conversation"],[116,30,124,28],[116,33,124,31,"response"],[116,41,124,39],[116,42,124,40,"data"],[116,46,124,44],[117,12,126,10],[117,18,126,16,"loadedMessages"],[117,32,126,41],[117,35,126,44,"conversation"],[117,47,126,56],[117,48,126,57,"messages"],[117,56,126,65],[117,57,126,66,"map"],[117,60,126,69],[117,61,126,71,"msg"],[117,64,126,79],[117,69,126,85],[118,14,127,12,"role"],[118,18,127,16],[118,20,127,18,"msg"],[118,23,127,21],[118,24,127,22,"role"],[118,28,127,26],[119,14,128,12,"content"],[119,21,128,19],[119,23,128,21,"msg"],[119,26,128,24],[119,27,128,25,"content"],[119,34,128,32],[120,14,129,12,"timestamp"],[120,23,129,21],[120,25,129,23],[120,29,129,27,"Date"],[120,33,129,31],[120,34,129,32,"msg"],[120,37,129,35],[120,38,129,36,"timestamp"],[120,47,129,45],[120,48,129,46],[121,14,130,12,"model_used"],[121,24,130,22],[121,26,130,24,"msg"],[121,29,130,27],[121,30,130,28,"model_used"],[122,12,131,10],[122,13,131,11],[122,14,131,12],[122,15,131,13],[123,12,133,10,"set"],[123,15,133,13],[123,16,133,14],[124,14,134,12,"messages"],[124,22,134,20],[124,24,134,22,"loadedMessages"],[124,38,134,36],[125,14,135,12,"conversationId"],[125,28,135,26],[125,30,135,28,"savedConversationId"],[125,49,135,47],[126,14,136,12,"personality"],[126,25,136,23],[126,27,136,25,"conversation"],[126,39,136,37],[126,40,136,38,"personality"],[127,12,137,10],[127,13,137,11],[127,14,137,12],[128,10,138,8],[128,11,138,9],[128,12,138,10],[128,19,138,17,"error"],[128,24,138,22],[128,26,138,24],[129,12,139,10,"console"],[129,19,139,17],[129,20,139,18,"error"],[129,25,139,23],[129,26,139,24],[129,55,139,53],[129,57,139,55,"error"],[129,62,139,60],[129,63,139,61],[130,12,140,10],[131,12,141,10],[131,18,141,16,"AsyncStorage"],[131,30,141,28],[131,31,141,28,"default"],[131,38,141,28],[131,39,141,29,"removeItem"],[131,49,141,39],[131,50,141,40],[131,66,141,56],[131,67,141,57],[132,10,142,8],[133,8,143,6],[134,6,144,4],[134,7,144,5],[134,8,144,6],[134,15,144,13,"error"],[134,20,144,18],[134,22,144,20],[135,8,145,6,"console"],[135,15,145,13],[135,16,145,14,"error"],[135,21,145,19],[135,22,145,20],[135,53,145,51],[135,55,145,53,"error"],[135,60,145,58],[135,61,145,59],[136,6,146,4],[137,4,147,2],[138,2,148,0],[138,3,148,1],[138,4,148,2],[138,5,148,3],[139,0,148,4],[139,3]],"functionMap":{"names":["<global>","create$argument_0","setPersonality","sendMessage","set$argument_0","clearMessages","loadPersistedData","conversation.messages.map$argument_0"],"mappings":"AAA;8CC6B;kBCO;GDU;eEE;YCiC;UDI;GFY;iBIE;GJO;qBKE;sECiB;YDK;GLgB;EDC"},"hasCjsExports":false},"type":"js/module"}]}