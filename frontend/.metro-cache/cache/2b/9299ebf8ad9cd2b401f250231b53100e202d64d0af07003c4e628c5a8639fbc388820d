{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"zustand","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":33,"index":33}}],"key":"POPvx7yS3Y3wz+S/9OAefiXNs0Q=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":34},"end":{"line":2,"column":69,"index":103}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"axios","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":104},"end":{"line":3,"column":26,"index":130}}],"key":"e45rENb5cSu0Yeh6oC1uWb7lEp4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"useChatStore\", {\n    enumerable: true,\n    get: function () {\n      return useChatStore;\n    }\n  });\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _zustand = require(_dependencyMap[1], \"zustand\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[2], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _axios = require(_dependencyMap[3], \"axios\");\n  var axios = _interopDefault(_axios);\n  const API_URL = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL || '';\n  const useChatStore = (0, _zustand.create)((set, get) => ({\n    messages: [],\n    personality: 'superintendent',\n    conversationId: null,\n    isLoading: false,\n    error: null,\n    setPersonality: async personality => {\n      set({\n        personality\n      });\n      await AsyncStorage.default.setItem('personality', personality);\n\n      // Call backend to update personality\n      try {\n        await axios.default.post(`${API_URL}/api/personality/toggle`, {\n          personality\n        });\n      } catch (error) {\n        console.error('Error updating personality:', error);\n      }\n    },\n    sendMessage: async message => {\n      const {\n        personality,\n        conversationId,\n        messages\n      } = get();\n\n      // Add user message immediately\n      const userMessage = {\n        role: 'user',\n        content: message,\n        timestamp: new Date()\n      };\n      set({\n        messages: [...messages, userMessage],\n        isLoading: true,\n        error: null\n      });\n      try {\n        const response = await axios.default.post(`${API_URL}/api/chat`, {\n          message,\n          personality,\n          conversation_id: conversationId\n        });\n        const {\n          data\n        } = response;\n        if (data.success) {\n          const assistantMessage = {\n            role: 'assistant',\n            content: data.response,\n            timestamp: new Date(),\n            model_used: data.model_used\n          };\n          set(state => ({\n            messages: [...state.messages, assistantMessage],\n            conversationId: data.conversation_id,\n            isLoading: false\n          }));\n\n          // Persist conversation ID\n          await AsyncStorage.default.setItem('conversationId', data.conversation_id);\n        }\n      } catch (error) {\n        console.error('Error sending message:', error);\n        set({\n          error: error.response?.data?.detail || error.message || 'Failed to send message',\n          isLoading: false\n        });\n      }\n    },\n    clearMessages: async () => {\n      set({\n        messages: [],\n        conversationId: null,\n        error: null\n      });\n      await AsyncStorage.default.removeItem('conversationId');\n    },\n    loadPersistedData: async () => {\n      try {\n        const [savedPersonality, savedConversationId] = await Promise.all([AsyncStorage.default.getItem('personality'), AsyncStorage.default.getItem('conversationId')]);\n        if (savedPersonality) {\n          set({\n            personality: savedPersonality\n          });\n        }\n        if (savedConversationId) {\n          // Load conversation history from backend\n          try {\n            const response = await axios.default.get(`${API_URL}/api/conversations/${savedConversationId}`);\n            const conversation = response.data;\n            const loadedMessages = conversation.messages.map(msg => ({\n              role: msg.role,\n              content: msg.content,\n              timestamp: new Date(msg.timestamp),\n              model_used: msg.model_used\n            }));\n            set({\n              messages: loadedMessages,\n              conversationId: savedConversationId,\n              personality: conversation.personality\n            });\n          } catch (error) {\n            console.error('Error loading conversation:', error);\n            // Clear invalid conversation ID\n            await AsyncStorage.default.removeItem('conversationId');\n          }\n        }\n      } catch (error) {\n        console.error('Error loading persisted data:', error);\n      }\n    }\n  }));\n});","lineCount":140,"map":[[12,2,30,0,"Object"],[12,8,30,0],[12,9,30,0,"defineProperty"],[12,23,30,0],[12,24,30,0,"exports"],[12,31,30,0],[13,4,30,0,"enumerable"],[13,14,30,0],[14,4,30,0,"get"],[14,7,30,0],[14,18,30,0,"get"],[14,19,30,0],[15,6,30,0],[15,13,30,0,"useChatStore"],[15,25,30,0],[16,4,30,0],[17,2,30,0],[18,2,148,4],[18,6,148,4,"_expoVirtualEnv"],[18,21,148,4],[18,24,148,4,"require"],[18,31,148,4],[18,32,148,4,"_dependencyMap"],[18,46,148,4],[19,2,1,0],[19,6,1,0,"_zustand"],[19,14,1,0],[19,17,1,0,"require"],[19,24,1,0],[19,25,1,0,"_dependencyMap"],[19,39,1,0],[20,2,2,0],[20,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[20,42,2,0],[20,45,2,0,"require"],[20,52,2,0],[20,53,2,0,"_dependencyMap"],[20,67,2,0],[21,2,2,0],[21,6,2,0,"AsyncStorage"],[21,18,2,0],[21,21,2,0,"_interopDefault"],[21,36,2,0],[21,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[21,73,2,0],[22,2,3,0],[22,6,3,0,"_axios"],[22,12,3,0],[22,15,3,0,"require"],[22,22,3,0],[22,23,3,0,"_dependencyMap"],[22,37,3,0],[23,2,3,0],[23,6,3,0,"axios"],[23,11,3,0],[23,14,3,0,"_interopDefault"],[23,29,3,0],[23,30,3,0,"_axios"],[23,36,3,0],[24,2,28,0],[24,8,28,6,"API_URL"],[24,15,28,13],[24,18,28,16,"_expoVirtualEnv"],[24,33,28,16],[24,34,28,16,"env"],[24,37,28,16],[24,38,28,16,"EXPO_PUBLIC_BACKEND_URL"],[24,61,28,16],[24,65,28,55],[24,67,28,57],[25,2,30,7],[25,8,30,13,"useChatStore"],[25,20,30,25],[25,23,30,28],[25,27,30,28,"create"],[25,35,30,34],[25,36,30,34,"create"],[25,42,30,34],[25,44,30,46],[25,45,30,47,"set"],[25,48,30,50],[25,50,30,52,"get"],[25,53,30,55],[25,59,30,61],[26,4,31,2,"messages"],[26,12,31,10],[26,14,31,12],[26,16,31,14],[27,4,32,2,"personality"],[27,15,32,13],[27,17,32,15],[27,33,32,31],[28,4,33,2,"conversationId"],[28,18,33,16],[28,20,33,18],[28,24,33,22],[29,4,34,2,"isLoading"],[29,13,34,11],[29,15,34,13],[29,20,34,18],[30,4,35,2,"error"],[30,9,35,7],[30,11,35,9],[30,15,35,13],[31,4,37,2,"setPersonality"],[31,18,37,16],[31,20,37,18],[31,26,37,25,"personality"],[31,37,37,49],[31,41,37,54],[32,6,38,4,"set"],[32,9,38,7],[32,10,38,8],[33,8,38,10,"personality"],[34,6,38,22],[34,7,38,23],[34,8,38,24],[35,6,39,4],[35,12,39,10,"AsyncStorage"],[35,24,39,22],[35,25,39,22,"default"],[35,32,39,22],[35,33,39,23,"setItem"],[35,40,39,30],[35,41,39,31],[35,54,39,44],[35,56,39,46,"personality"],[35,67,39,57],[35,68,39,58],[37,6,41,4],[38,6,42,4],[38,10,42,8],[39,8,43,6],[39,14,43,12,"axios"],[39,19,43,17],[39,20,43,17,"default"],[39,27,43,17],[39,28,43,18,"post"],[39,32,43,22],[39,33,43,23],[39,36,43,26,"API_URL"],[39,43,43,33],[39,68,43,58],[39,70,43,60],[40,10,43,62,"personality"],[41,8,43,74],[41,9,43,75],[41,10,43,76],[42,6,44,4],[42,7,44,5],[42,8,44,6],[42,15,44,13,"error"],[42,20,44,18],[42,22,44,20],[43,8,45,6,"console"],[43,15,45,13],[43,16,45,14,"error"],[43,21,45,19],[43,22,45,20],[43,51,45,49],[43,53,45,51,"error"],[43,58,45,56],[43,59,45,57],[44,6,46,4],[45,4,47,2],[45,5,47,3],[46,4,49,2,"sendMessage"],[46,15,49,13],[46,17,49,15],[46,23,49,22,"message"],[46,30,49,37],[46,34,49,42],[47,6,50,4],[47,12,50,10],[48,8,50,12,"personality"],[48,19,50,23],[49,8,50,25,"conversationId"],[49,22,50,39],[50,8,50,41,"messages"],[51,6,50,50],[51,7,50,51],[51,10,50,54,"get"],[51,13,50,57],[51,14,50,58],[51,15,50,59],[53,6,52,4],[54,6,53,4],[54,12,53,10,"userMessage"],[54,23,53,30],[54,26,53,33],[55,8,54,6,"role"],[55,12,54,10],[55,14,54,12],[55,20,54,18],[56,8,55,6,"content"],[56,15,55,13],[56,17,55,15,"message"],[56,24,55,22],[57,8,56,6,"timestamp"],[57,17,56,15],[57,19,56,17],[57,23,56,21,"Date"],[57,27,56,25],[57,28,56,26],[58,6,57,4],[58,7,57,5],[59,6,59,4,"set"],[59,9,59,7],[59,10,59,8],[60,8,60,6,"messages"],[60,16,60,14],[60,18,60,16],[60,19,60,17],[60,22,60,20,"messages"],[60,30,60,28],[60,32,60,30,"userMessage"],[60,43,60,41],[60,44,60,42],[61,8,61,6,"isLoading"],[61,17,61,15],[61,19,61,17],[61,23,61,21],[62,8,62,6,"error"],[62,13,62,11],[62,15,62,13],[63,6,63,4],[63,7,63,5],[63,8,63,6],[64,6,65,4],[64,10,65,8],[65,8,66,6],[65,14,66,12,"response"],[65,22,66,20],[65,25,66,23],[65,31,66,29,"axios"],[65,36,66,34],[65,37,66,34,"default"],[65,44,66,34],[65,45,66,35,"post"],[65,49,66,39],[65,50,66,40],[65,53,66,43,"API_URL"],[65,60,66,50],[65,71,66,61],[65,73,66,63],[66,10,67,8,"message"],[66,17,67,15],[67,10,68,8,"personality"],[67,21,68,19],[68,10,69,8,"conversation_id"],[68,25,69,23],[68,27,69,25,"conversationId"],[69,8,70,6],[69,9,70,7],[69,10,70,8],[70,8,72,6],[70,14,72,12],[71,10,72,14,"data"],[72,8,72,19],[72,9,72,20],[72,12,72,23,"response"],[72,20,72,31],[73,8,74,6],[73,12,74,10,"data"],[73,16,74,14],[73,17,74,15,"success"],[73,24,74,22],[73,26,74,24],[74,10,75,8],[74,16,75,14,"assistantMessage"],[74,32,75,39],[74,35,75,42],[75,12,76,10,"role"],[75,16,76,14],[75,18,76,16],[75,29,76,27],[76,12,77,10,"content"],[76,19,77,17],[76,21,77,19,"data"],[76,25,77,23],[76,26,77,24,"response"],[76,34,77,32],[77,12,78,10,"timestamp"],[77,21,78,19],[77,23,78,21],[77,27,78,25,"Date"],[77,31,78,29],[77,32,78,30],[77,33,78,31],[78,12,79,10,"model_used"],[78,22,79,20],[78,24,79,22,"data"],[78,28,79,26],[78,29,79,27,"model_used"],[79,10,80,8],[79,11,80,9],[80,10,82,8,"set"],[80,13,82,11],[80,14,82,12,"state"],[80,19,82,17],[80,24,82,22],[81,12,83,10,"messages"],[81,20,83,18],[81,22,83,20],[81,23,83,21],[81,26,83,24,"state"],[81,31,83,29],[81,32,83,30,"messages"],[81,40,83,38],[81,42,83,40,"assistantMessage"],[81,58,83,56],[81,59,83,57],[82,12,84,10,"conversationId"],[82,26,84,24],[82,28,84,26,"data"],[82,32,84,30],[82,33,84,31,"conversation_id"],[82,48,84,46],[83,12,85,10,"isLoading"],[83,21,85,19],[83,23,85,21],[84,10,86,8],[84,11,86,9],[84,12,86,10],[84,13,86,11],[86,10,88,8],[87,10,89,8],[87,16,89,14,"AsyncStorage"],[87,28,89,26],[87,29,89,26,"default"],[87,36,89,26],[87,37,89,27,"setItem"],[87,44,89,34],[87,45,89,35],[87,61,89,51],[87,63,89,53,"data"],[87,67,89,57],[87,68,89,58,"conversation_id"],[87,83,89,73],[87,84,89,74],[88,8,90,6],[89,6,91,4],[89,7,91,5],[89,8,91,6],[89,15,91,13,"error"],[89,20,91,23],[89,22,91,25],[90,8,92,6,"console"],[90,15,92,13],[90,16,92,14,"error"],[90,21,92,19],[90,22,92,20],[90,46,92,44],[90,48,92,46,"error"],[90,53,92,51],[90,54,92,52],[91,8,93,6,"set"],[91,11,93,9],[91,12,93,10],[92,10,94,8,"error"],[92,15,94,13],[92,17,94,15,"error"],[92,22,94,20],[92,23,94,21,"response"],[92,31,94,29],[92,33,94,31,"data"],[92,37,94,35],[92,39,94,37,"detail"],[92,45,94,43],[92,49,94,47,"error"],[92,54,94,52],[92,55,94,53,"message"],[92,62,94,60],[92,66,94,64],[92,90,94,88],[93,10,95,8,"isLoading"],[93,19,95,17],[93,21,95,19],[94,8,96,6],[94,9,96,7],[94,10,96,8],[95,6,97,4],[96,4,98,2],[96,5,98,3],[97,4,100,2,"clearMessages"],[97,17,100,15],[97,19,100,17],[97,25,100,17,"clearMessages"],[97,26,100,17],[97,31,100,29],[98,6,101,4,"set"],[98,9,101,7],[98,10,101,8],[99,8,102,6,"messages"],[99,16,102,14],[99,18,102,16],[99,20,102,18],[100,8,103,6,"conversationId"],[100,22,103,20],[100,24,103,22],[100,28,103,26],[101,8,104,6,"error"],[101,13,104,11],[101,15,104,13],[102,6,105,4],[102,7,105,5],[102,8,105,6],[103,6,106,4],[103,12,106,10,"AsyncStorage"],[103,24,106,22],[103,25,106,22,"default"],[103,32,106,22],[103,33,106,23,"removeItem"],[103,43,106,33],[103,44,106,34],[103,60,106,50],[103,61,106,51],[104,4,107,2],[104,5,107,3],[105,4,109,2,"loadPersistedData"],[105,21,109,19],[105,23,109,21],[105,29,109,21,"loadPersistedData"],[105,30,109,21],[105,35,109,33],[106,6,110,4],[106,10,110,8],[107,8,111,6],[107,14,111,12],[107,15,111,13,"savedPersonality"],[107,31,111,29],[107,33,111,31,"savedConversationId"],[107,52,111,50],[107,53,111,51],[107,56,111,54],[107,62,111,60,"Promise"],[107,69,111,67],[107,70,111,68,"all"],[107,73,111,71],[107,74,111,72],[107,75,112,8,"AsyncStorage"],[107,87,112,20],[107,88,112,20,"default"],[107,95,112,20],[107,96,112,21,"getItem"],[107,103,112,28],[107,104,112,29],[107,117,112,42],[107,118,112,43],[107,120,113,8,"AsyncStorage"],[107,132,113,20],[107,133,113,20,"default"],[107,140,113,20],[107,141,113,21,"getItem"],[107,148,113,28],[107,149,113,29],[107,165,113,45],[107,166,113,46],[107,167,114,7],[107,168,114,8],[108,8,116,6],[108,12,116,10,"savedPersonality"],[108,28,116,26],[108,30,116,28],[109,10,117,8,"set"],[109,13,117,11],[109,14,117,12],[110,12,117,14,"personality"],[110,23,117,25],[110,25,117,27,"savedPersonality"],[111,10,117,59],[111,11,117,60],[111,12,117,61],[112,8,118,6],[113,8,120,6],[113,12,120,10,"savedConversationId"],[113,31,120,29],[113,33,120,31],[114,10,121,8],[115,10,122,8],[115,14,122,12],[116,12,123,10],[116,18,123,16,"response"],[116,26,123,24],[116,29,123,27],[116,35,123,33,"axios"],[116,40,123,38],[116,41,123,38,"default"],[116,48,123,38],[116,49,123,39,"get"],[116,52,123,42],[116,53,123,43],[116,56,123,46,"API_URL"],[116,63,123,53],[116,85,123,75,"savedConversationId"],[116,104,123,94],[116,106,123,96],[116,107,123,97],[117,12,124,10],[117,18,124,16,"conversation"],[117,30,124,28],[117,33,124,31,"response"],[117,41,124,39],[117,42,124,40,"data"],[117,46,124,44],[118,12,126,10],[118,18,126,16,"loadedMessages"],[118,32,126,41],[118,35,126,44,"conversation"],[118,47,126,56],[118,48,126,57,"messages"],[118,56,126,65],[118,57,126,66,"map"],[118,60,126,69],[118,61,126,71,"msg"],[118,64,126,79],[118,69,126,85],[119,14,127,12,"role"],[119,18,127,16],[119,20,127,18,"msg"],[119,23,127,21],[119,24,127,22,"role"],[119,28,127,26],[120,14,128,12,"content"],[120,21,128,19],[120,23,128,21,"msg"],[120,26,128,24],[120,27,128,25,"content"],[120,34,128,32],[121,14,129,12,"timestamp"],[121,23,129,21],[121,25,129,23],[121,29,129,27,"Date"],[121,33,129,31],[121,34,129,32,"msg"],[121,37,129,35],[121,38,129,36,"timestamp"],[121,47,129,45],[121,48,129,46],[122,14,130,12,"model_used"],[122,24,130,22],[122,26,130,24,"msg"],[122,29,130,27],[122,30,130,28,"model_used"],[123,12,131,10],[123,13,131,11],[123,14,131,12],[123,15,131,13],[124,12,133,10,"set"],[124,15,133,13],[124,16,133,14],[125,14,134,12,"messages"],[125,22,134,20],[125,24,134,22,"loadedMessages"],[125,38,134,36],[126,14,135,12,"conversationId"],[126,28,135,26],[126,30,135,28,"savedConversationId"],[126,49,135,47],[127,14,136,12,"personality"],[127,25,136,23],[127,27,136,25,"conversation"],[127,39,136,37],[127,40,136,38,"personality"],[128,12,137,10],[128,13,137,11],[128,14,137,12],[129,10,138,8],[129,11,138,9],[129,12,138,10],[129,19,138,17,"error"],[129,24,138,22],[129,26,138,24],[130,12,139,10,"console"],[130,19,139,17],[130,20,139,18,"error"],[130,25,139,23],[130,26,139,24],[130,55,139,53],[130,57,139,55,"error"],[130,62,139,60],[130,63,139,61],[131,12,140,10],[132,12,141,10],[132,18,141,16,"AsyncStorage"],[132,30,141,28],[132,31,141,28,"default"],[132,38,141,28],[132,39,141,29,"removeItem"],[132,49,141,39],[132,50,141,40],[132,66,141,56],[132,67,141,57],[133,10,142,8],[134,8,143,6],[135,6,144,4],[135,7,144,5],[135,8,144,6],[135,15,144,13,"error"],[135,20,144,18],[135,22,144,20],[136,8,145,6,"console"],[136,15,145,13],[136,16,145,14,"error"],[136,21,145,19],[136,22,145,20],[136,53,145,51],[136,55,145,53,"error"],[136,60,145,58],[136,61,145,59],[137,6,146,4],[138,4,147,2],[139,2,148,0],[139,3,148,1],[139,4,148,2],[139,5,148,3],[140,0,148,4],[140,3]],"functionMap":{"names":["<global>","create$argument_0","setPersonality","sendMessage","set$argument_0","clearMessages","loadPersistedData","conversation.messages.map$argument_0"],"mappings":"AAA;8CC6B;kBCO;GDU;eEE;YCiC;UDI;GFY;iBIE;GJO;qBKE;sECiB;YDK;GLgB;EDC"},"hasCjsExports":false},"type":"js/module"}]}